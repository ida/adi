<div class="blockers" metal:define-macro="blockers"
   tal:define="dependency_of context/getIsDependencyOf;
               depends_on context/getDependsOn;"
   tal:condition="python: dependency_of + depends_on != ''">

  <tal:surpressors tal:condition="depends_on"
    tal:define="surpressors python: depends_on.split(',')">
    Is blocked by
    <tal:surpressor tal:repeat="surpressor surpressors">
      <tal:getResults tal:condition="python: surpressor != ''"
        tal:define="
        results python:context.portal_catalog.searchResults(id = surpressor);
        hasResults python: len(results) > 0;">
        <tal:hasResults tal:condition="hasResults">
          <tal:getObjUrl tal:define="obj python: results[0].getObject();
                                     obj_url obj/absolute_url;">
            <a tal:attributes="href obj_url"
               tal:content="string:#${surpressor}">
              #27
            </a>
          </tal:getObjUrl>
        </tal:hasResults>
      </tal:getResults>
    </tal:surpressor>
    !!!
  </tal:surpressors>

  <tal:surpressing
    tal:condition="dependency_of"
    tal:define="surpressing python: dependency_of.split(',')"
    >
    Is blocking
    <tal:surpressed tal:repeat="surpressed surpressing">
      <tal:getResults tal:condition="python: surpressed != ''"
        tal:define="
        results python:context.portal_catalog.searchResults(id = surpressed);
        hasResults python: len(results) > 0;">
        <tal:hasResults tal:condition="hasResults">
          <tal:getObjUrl tal:define="obj python: results[0].getObject();
                                     obj_url obj/absolute_url;">
            <a tal:attributes="href obj_url"
               tal:content="string:#${surpressed}">
              #42
            </a>
          </tal:getObjUrl>
        </tal:hasResults>
      </tal:getResults>
    </tal:surpressed>
    !!!
  </tal:surpressing>
</div><tal:comment tal:replace="nothing">EO .blockers</tal:comment>
